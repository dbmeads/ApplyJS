(function(e,t){"use strict";function n(e,n){function L(e){e.prototype={}}var r={},i=e.extend,s=e.proxy,o=Array.prototype.push,u=Array.prototype.slice,a=e.when;r.abstraction={extend:i,proxy:s,when:a};var f=function(e){if(m(e)||h(e))return h(e)?e.prototype:Object.getPrototypeOf(e)},l=function(e){return f(e)===Array.prototype},c=function(){if(arguments[0]!==t){var e=arguments[0].split("."),r=arguments[1]||n;for(var i=0;i<e.length;i++){if(!r[e[i]])return!1;r=r[e[i]]}return!0}return!1},h=function(e){return typeof e=="function"},p=function(e,t){if(h(e)){if(f(t)===e.prototype)return!0;if(c("constructor.mixins",t)){var n=t.constructor.mixins;for(var r=0;r<n.length;r++)if(n[r]===e)return!0}}return!1},d=function(e){return h(e)?e.compose!==t:g(e)?e.constructor.compose!==t:!1},v=function(e){return typeof e=="number"},m=function(e){return h(e)||typeof e=="object"},g=function(e){return!l(e)&&typeof e=="object"},y=function(e){return typeof e=="string"};i(r,{getPrototypeOf:f,isArray:l,isDefined:c,isFunction:h,isInstanceOf:p,isComposed:d,isNumber:v,isObject:m,isPlainObject:g,isString:y});var b=function(e,t){return t&&(e[e.length-1]=t),e[e.length-1]},w=function(e,t,n){n=n||{};var r=n.context||this,i;if(n.reverse)for(i=n.start||e.length-1;i>=0;i--)t.call(r,e[i],i);else for(i=n.start||0;i<e.length;i++)t.call(r,e[i],i)};i(r,{last:b,loop:w});var E=/^(0|[1-9][0-9]*)$/,S=function(e){return E.test(e)},x=function(e,t){return e.indexOf(t)===e.length-t.length};r.string={endsWith:x,isNumeric:S};var T=r.namespace=function(){var e=u.apply(arguments),r=n;if(!y(e[0])){r=e.shift();if(!r)throw'Attempting to extend/access "'+e[0]+'" on an undefined namespace.'}var i=e[0],s=e[1];if(i!==t){var o=i.split(".");w(o,function(e,t){t===o.length-1?s&&(r[e]=s):r[e]||(r[e]={}),r=r[e]})}return r},N=r.cascade=function(e,t,n){var r=[];w(e,function(e){e[t]&&r.push(e[t])},{reverse:n});if(r.length)return function(){var e,t=u.apply(arguments);return w(r,function(n){e=n.apply(this,t)},{context:this}),e}},C=function(){function e(e,t){var n=u.apply(t);return y(n[0])?[n.shift(),e].concat(n):[e].concat(n)}function n(){var t=function(){if(!this||this.constructor!==t)return k.apply(this||{},e(t,arguments));this.init&&this.init.apply(this,arguments)};return t}function r(t,n){t.objects=[],t.mixins=n,t.generators=[],t.cascades={init:["init"]},t.cascade=function(e){T(t,"cascades."+e,arguments);var n=N.apply(this,[this.objects].concat(u.apply(arguments)));return n&&(t.prototype[e]=n),t},t.singleton=function(){var e=u.apply(arguments);return e.push(t),O.apply(this,e)},t.merge=function(e){return i(t.prototype,e),t},t.compose=function(){return arguments.length===0?C(t.mixins,t):k.apply(this,e(t,arguments))},t.generator=function(e){return e&&t.generators.push(e),t},w(n,function(e){h(e)?(t.objects.push(e.prototype),i(t.cascades,e.cascades),e.generators&&o.apply(t.generators,e.generators)):t.objects.push(e)})}function s(e){var t=e.cascades;for(var n in t)e.cascade.apply(e,t[n])}function a(e){e.prototype.isInstanceOf=function(e){return p(e,this)}}function f(e){i.apply(t,[e.prototype].concat(e.objects)),s(e),a(e)}function l(e){w(e.generators,function(t){t.call(e,e)})}return function(e,t){return t||(t=n()),r(t,e),f(t),l(t),t}}(),k=r.compose=function(){var e=u.apply(arguments),t;y(e[0])&&(t=e.shift());var n=C(e);return t&&T(t,n),n};r.decompose=function(){var e=u.apply(arguments),t;if(e.length>1){t=e.shift();if(d(t)){L(t);for(var n=0;n<e.length;n++){var r=t.mixins.indexOf(e[n]);r>=0&&t.mixins.splice(r,1)}t.compose()}}return t};var A=function(){},O=r.singleton=function(){var e=u.apply(arguments),t=[];g(e[0])&&t.push(e.shift()),y(e[0])&&t.push(e.shift());var n=[];l(e[0])&&(n=e.shift());var r={};return h(e[0])&&(A.prototype=e[0].prototype,r=new A,r.constructor=e[0],e[0].apply(r,n)),t.length>0&&(t.push(r),T.apply(this,t)),r},M=function(){w(arguments,function(e){this[e]=function(t){return this.log({level:e,message:t})}},{context:this})},_=r.Logger=k({init:function(){this.levels={},this.config({debug:!0,info:!0,warning:!0,error:!0})},config:function(e){i(this.levels,e);for(var t in e)this[t]||M.call(this,t)},log:function(e){var t=e.level;return t&&this.levels[t]&&e.message&&console.log(e.message),this}}).cascade("log",!0),D=r.logger=_.singleton(),P=r.Events=k({init:function(){this.events||(this.events={})},on:function(e,t,n){var r=this.events[e];r||(r=this.events[e]=[]),n&&(t=s(t,n)),r.push(t)},trigger:function(e){var t=this.events[e];if(t){var n=u.apply(arguments);n.shift();for(var r=0;r<t.length;r++)t[r].apply(this,n)}}}),H=function(e,t){return function(){return this.parent&&this.parent[e]?this.parent[e].apply(this.parent,arguments):t.apply(this,arguments)}},B=function(t){var n=e.Deferred(),r={};for(var s=1;s<arguments.length;s++)arguments[s]&&(h(arguments[s])?n.then(arguments[s]):arguments[s].success&&(n.then(arguments[s].success),delete arguments[s].success),i(r,arguments[s]));return a(e.ajax(r)).then(function(e){j(t,e,r),n.resolve(t,e,r)}),n.promise()},j=function(e,t,n){n.type==="GET"&&(h(e.inflate)?e.inflate(e.parse(t)):i(e,t))},F=r.Crud=P({save:H("save",function(e){return B(this,{contentType:this.contentType,data:this.toString(),type:this.getId&&this.getId()?"PUT":"POST",url:this.getUrl()},e)}),fetch:H("fetch",function(e){return B(this,{url:this.getUrl(),type:"GET"},e)}),destroy:H("destroy",function(e){return B(this,{url:this.getUrl(),type:"DELETE"},e)}),toString:function(){return JSON.stringify(this.deflate?this.deflate():this)},parse:function(e){return e},contentType:"application/json"}),I=function(e,t,n){if(t){e||(e={});for(var r in t)if(e[r]){var i=new t[r](e[r]);n&&(i.parent=n),e[r]=i}}return e},q=function(e,t){if(t)for(var n in t)e[n].deflate&&(e[n]=e[n].deflate());return e},R=r.Model=F({id:"id",urlRoot:"",init:function(e){this.attributes={},this.set(e)},set:function(e){e&&h(e.deflate)&&(e=e.deflate()),i(this.attributes,I(e,this.mappings,this));for(var t in e)this.trigger("change:"+t,this.attributes[t],this);return this.trigger("change",this.attributes[t],t),this},get:function(e){return this.attributes[e]},getId:function(){return this.attributes[this.id]},getUrl:function(){return this.urlRoot+(this.attributes.id?"/"+this.attributes.id:"")},deflate:function(){return q(i({},this.attributes),this.mappings)},inflate:function(e){return this.set(e)}}),U=function(e,t){e.list.push(t),e.trigger("add",t)},z=function(e,t){for(var n=0;n<e.list.length;n++)e.list[n]===t&&(e.list.splice(n,1),e.trigger("remove",t))},W=r.List=F({urlRoot:"",mapping:r.Model,init:function(e){this.list=[],this.add(e)},size:function(){return this.list.length},get:function(e){return this.list[e]},add:function(e){if(l(e))for(var t in e)U(this,new this.mapping(e[t]));else if(e)if(f(e)===f(this.mapping))U(this,e);else{if(d(e))throw"Attempted to add an incompatible model to a list.";U(this,new this.mapping(e))}return this},remove:function(e){l(e)||(e=[e]);for(var t in e)z(this,e[t]);return this},getUrl:function(){return this.urlRoot},deflate:function(){var e=[];for(var t=0;t<this.list.length;t++)e.push(this.list[t].deflate?this.list[t].deflate():this.list[t]);return e},inflate:function(e){return this.add(e)}});r.Router=k({init:function(){this.routes={},this.current=t},compile:function(e){try{for(var t in e)T(this.routes,t.replace(/^\//,"").replace("/","."),e[t])}catch(n){console.log(n)}},route:function(e){return this.compile(e),!this.iid&&this.autostart&&this.start(),this}});var X=r.router=r.Router.singleton();return r.route=s(X.route,X),r.toScope=function(e){i(e,r)},r}var r;e.jQuery&&(r=e.apply=n(e.jQuery,e));if(typeof e.define=="function"&&e.define.amd)e.define("apply",["jquery"],function(t){return r=r||n(t,e),r});else if(typeof require=="function")exports=r=r||n(require("jquery"),exports);else if(!r)throw"ApplyJS was unable to locate jQuery."})(this),function(root,undefined){"use strict";function init($,apply,root){var proxy=apply.abstraction.proxy,when=apply.abstraction.when,resources={},outstanding={deferreds:[],add:function(e){return this.deferreds.push(e),e},wait:function(e){var t=when.apply($,this.deferreds);return e&&t.then(e),t}},dependency=apply.dependency=function(resource,promise){if(!resources[resource]){var deferred=outstanding.add($.ajax({url:resource}));apply.string.endsWith(resource,".js")&&deferred.then(function(source){return eval(source)}),resources[resource]=deferred}return resources[resource].promise(promise)};apply.dependencies=function(){var e=[];return apply.loop(arguments,function(t){e.push(dependency(t))}),when(e)},dependency.wait=proxy(outstanding.wait,outstanding),apply.ready=function(e){dependency.wait(e)};var div="<div></div>",preventDefault=function(e){return function(t){return t.preventDefault(),e.apply(this,arguments)}},bind=function(e,t,n){for(var r in t){var i=r.split(" ").pop(),s=t[r];i==="submit"&&(s=preventDefault(s)),e.on(i,r.replace(i,""),proxy(s,n))}},setupRootEl=function(e){e.$el=$(e.rootHtml),e.events&&bind(e.$el,e.events,e)},peel=function(e,t){if(t){var n=$(t);if(n.size()>1)throw(e.resource?e.resource:"All view source")+" must have a single root element.";e.template=e.compile(n.html()),e.rootHtml=$(div).html(n.empty()).html()}else e.template=e.compile("")},renderDataElement=function(e,t,n,r){var i=$(t),s=i.attr("data");e.set(i,apply.namespace(r,s)),n.on&&n.on("change:"+s,function(t){e.set(i,t)}),(i.is("input")||i.is("textarea"))&&i.on("change",function(e){var t=i.val();if(n.set){var r={};r[s]=t,n.set(r)}else n[s]=t})},dataBinding={render:function(){var e=this;this.data||(this.data=new apply.Model);var t=this.data,n=t;return t.deflate&&(n=t.deflate()),this.$el.attr("data")&&renderDataElement(this,this.$el,t,n),this.$el.find("[data]").each(function(r,i){renderDataElement(e,i,t,n)}),this.$el},set:function(e,t){e.is("input")||e.is("textarea")?e.val()!==t&&e.val(t):e.text()!==t&&e.text(t)}},view=apply.View=apply.compose({urlRoot:"",rootHtml:div,init:function(e){e=e||{},e.data&&(this.data=e.data)},template:function(){return""},render:function(){if(!this.template)throw"Please wait for "+this.resource+" before rendering.";return this.$el||setupRootEl(this),this.$el.html(this.template(this.data))},compile:function(e){return function(){return e||""}}},dataBinding).generator(function(){var e=this.prototype;e.resource?(delete e.template,apply.dependency(e.urlRoot+e.resource).promise(this),this.done(function(t){peel(e,t)})):peel(e,e.source)}).cascade("render");apply.mixins={view:{dataBinding:dataBinding,renderer:{dynamic:{attachTo:"",render:function(e){var t=this.$el;return e&&(this.attachTo?t.find(this.attachTo).html(e.render()):t.html(e.render())),t}},children:{children:{},render:function(e){var t=this.$el;for(var n in this.children){var r=t.find(n).empty();r.size()===0&&t.is(n)&&(r=t);var i=this.children[n];if(apply.isArray(i))for(var s=0;s<i.length;s++)r.append(i[s].render());else r.append(i.render())}return t}},list:{itemView:view,render:function(){var e=this.$el,t=e;this.attachTo&&(t=e.find(this.attachTo));var n=this.itemView,r=this.data||[];return r.list&&(r=r.list),$.each(r,function(e,r){t.append((new n({data:r})).render())}),e}}}}},apply.Router.Web=apply.Router({autostart:!0,check:function(){if(root.location.hash!==this.current){var e=this.current=root.location.hash,t=e.replace(/^#?\/?/,"").split("/"),n=[],r=this.routes;for(var i=0;i<t.length;i++){var s=t[i];if(r[s])r=r[s];else{if(!r["*"])break;n.push(apply.string.isNumeric(s)?Number(s):s),r=r["*"]}}apply.isFunction(r)&&r.apply(this,n)}},start:function(e){e=e||{};var t=proxy(this.check,this);return this.iid=setInterval(t,e.interval||50),this},stop:function(){clearInterval(this.iid),delete this.iid}});var router=apply.router=root.document?apply.Router.Web.singleton():apply.Router.singleton();return apply.route=proxy(router.route,router),apply}root.jQuery&&init(root.jQuery,root.apply,root),typeof root.define=="function"&&root.define.amd?root.define("apply/web",["jquery","apply"],function(e,t){return init(e,t,root)}):typeof require=="function"&&(exports=init(require("jquery"),require("./apply.js"),exports))}(this);