(function(root){"use strict";function resolveDependencies(e,t,n){var r=[];if(t)for(var i=0;i<t.length;i++){var s=t[i];modules[s]?r.push(modules[s].factory.apply(root,modules[s].resolved)):addToWaiting(e,s,{factory:e,dependencies:t,module:n})}(!t||r.length===t.length)&&handleResolved(e,r,n)}function addToWaiting(e,t,n){e.unresolved||(e.unresolved=[]);var r=waiting[t];r||(r=waiting[t]=[]),r.push(n),e.unresolved.push(t),r.length===1&&fetch(t)}function handleResolved(e,t,n){e.unresolved&&delete e.unresolved,e.apply(root,t),n&&(modules[n]={factory:e,resolved:t},resolveWaiting(n))}function resolveWaiting(e){var t=waiting[e];if(t)for(var n=0;n<t.length;n++){var r=t[n];resolveDependencies.call(root,r.factory,r.dependencies,r.module)}delete waiting[e]}function resolveURL(e){var t=e.split("/");return t[t.length-1].indexOf(".")===-1&&(e+=".js"),e}function fetch(module){var request=new root.XMLHttpRequest,url=resolveURL(module);request.open("GET",url,!1),request.send();var response=request.responseText;request.status===200&&(url.indexOf(".js")>=0?eval(response):(modules[module]={factory:function(){return response},resolved:[]},resolveWaiting(module)))}var modules={},waiting={};if(typeof root.define!="function"||!root.define.amd||typeof root.require!="function")root.define=function(){var e,t,n;for(var r=0;r<arguments.length;r++){var i=arguments[r],s=typeof i;s==="function"?t=i:s==="string"?n=i:s==="object"&&i.length&&(e=i)}resolveDependencies(t,e,n)},root.define.amd={jQuery:!0},root.require=function(e,t){resolveDependencies(t,e)}})(this),function(e){"use strict";var t;define("apply/core",function(){return t=e.apply=t||{},t})}(this),function(e){"use strict";function n(n){if(!t){t=!0;var r=[].slice,i=n.extend=function(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])e[n]=arguments[t][n];return e},s=n.proxy=function(e,t){return function(){return e.apply(t,arguments)}},o=n.array=function(e){return r.call(e)},u=function(e){if(d(e)||l(e))return l(e)?e.prototype:Object.getPrototypeOf(e)},a=function(e){return u(e)===Array.prototype},f=function(){if(arguments[0]!==undefined){var t=arguments[0].split("."),n=arguments[1]||e;for(var r=0;r<t.length;r++){if(!n[t[r]])return!1;n=n[t[r]]}return!0}return!1},l=function(e){return typeof e=="function"},c=function(e,t){if(l(e)){if(u(t)===e.prototype)return!0;if(f("constructor.mixins",t)){var n=t.constructor.mixins;for(var r=0;r<n.length;r++)if(n[r]===e)return!0}}return!1},h=function(e){return l(e)?e.compose!==undefined:v(e)?e.constructor.compose!==undefined:!1},p=function(e){return typeof e=="number"},d=function(e){return l(e)||typeof e=="object"},v=function(e){return!a(e)&&typeof e=="object"},m=function(e){return typeof e=="string"};i(n,{getPrototypeOf:u,isArray:a,isDefined:f,isFunction:l,isInstanceOf:c,isComposed:h,isNumber:p,isObject:d,isPlainObject:v,isString:m});var g=function(e,t){return t&&(e[e.length-1]=t),e[e.length-1]},y=function(e,t,n){n=n||{};var r=n.context||this,i;if(n.reverse)for(i=n.start||e.length-1;i>=0;i--)t.call(r,e[i],i);else for(i=n.start||0;i<e.length;i++)t.call(r,e[i],i)};i(n,{last:g,loop:y});var b=/^(0|[1-9][0-9]*)$/,w=function(e){return b.test(e)},E=function(e,t){return e.indexOf(t)===e.length-t.length};n.string={endsWith:E,isNumeric:w};var S=n.namespace=function(){var t=r.call(arguments),n=e;if(!m(t[0])){n=t.shift();if(!n)throw'Attempting to extend/access "'+t[0]+'" on an undefined namespace.'}var i=t[0],s=t[1];if(i!==undefined){var o=i.split(".");y(o,function(e,t){t===o.length-1?s&&(n[e]=s):n[e]||(n[e]={}),n=n[e]})}return n};n.delegateToParent=function(e,t){return function(){return this.parent&&this.parent[e]?this.parent[e].apply(this.parent,arguments):t.apply(this,arguments)}}}return n}var t;define("apply/util",["apply/core"],function(e){return n(e)})}(this),function(e){"use strict";function n(e){if(!t){t=!0;var n=e.array,r=e.extend,i=e.isArray,s=e.isComposed,o=e.isFunction,u=e.isInstanceOf,a=e.isPlainObject,f=e.isString,l=e.loop,c=e.namespace,h=[].push,p=e.cascade=function(e,t,r){var i=[];l(e,function(e){e[t]&&i.push(e[t])},{reverse:r});if(i.length)return function(){var e,t=n(arguments);return l(i,function(n){e=n.apply(this,t)},{context:this}),e}},d=function(){function e(e,t){var r=n(t);return f(r[0])?[r.shift(),e].concat(r):[e].concat(r)}function t(){var t=function(){if(!this||this.constructor!==t)return v.apply(this||{},e(t,arguments));this.init&&this.init.apply(this,arguments)};return t}function i(t,i){t.objects=[],t.mixins=i,t.generators=[],t.cascades={init:["init"]},t.cascade=function(e){c(t,"cascades."+e,arguments);var r=p.apply(this,[this.objects].concat(n(arguments)));return r&&(t.prototype[e]=r),t},t.singleton=function(){var e=n(arguments);return e.push(t),y.apply(this,e)},t.merge=function(e){return r(t.prototype,e),t},t.compose=function(){return arguments.length===0?d(t.mixins,t):v.apply(this,e(t,arguments))},t.generator=function(e){return e&&t.generators.push(e),t},l(i,function(e){o(e)?(t.objects.push(e.prototype),r(t.cascades,e.cascades),e.generators&&h.apply(t.generators,e.generators)):t.objects.push(e)})}function s(e){var t=e.cascades;for(var n in t)e.cascade.apply(e,t[n])}function a(e){e.prototype.isInstanceOf=function(e){return u(e,this)}}function m(e){r.apply(undefined,[e.prototype].concat(e.objects)),s(e),a(e)}function g(e){l(e.generators,function(t){t.call(e,e)})}return function(e,n){return n||(n=t()),i(n,e),m(n),g(n),n}}(),v=e.compose=function(){var e=n(arguments),t;f(e[0])&&(t=e.shift());var r=d(e);return t&&c(t,r),r},m=function(e){e.prototype={}};e.decompose=function(){var e=n(arguments),t;if(e.length>1){t=e.shift();if(s(t)){m(t);for(var r=0;r<e.length;r++){var i=t.mixins.indexOf(e[r]);i>=0&&t.mixins.splice(i,1)}t.compose()}}return t};var g=function(){},y=e.singleton=function(){var e=n(arguments),t=[];a(e[0])&&t.push(e.shift()),f(e[0])&&t.push(e.shift());var r=[];i(e[0])&&(r=e.shift());var s={};return o(e[0])&&(g.prototype=e[0].prototype,s=new g,s.constructor=e[0],e[0].apply(s,r)),t.length>0&&(t.push(s),c.apply(this,t)),s}}return e}var t;define("apply/construct",["apply/util"],function(e){return n(e)})}(this),function(e){"use strict";function n(e){return t||(t=!0,e.Events=e.compose({init:function(){this.events||(this.events={})},on:function(t,n,r){var i=this.events[t];i||(i=this.events[t]=[]),r&&(n=e.proxy(n,r)),i.push(n)},trigger:function(t){var n=this.events[t];if(n){var r=e.array(arguments);r.shift();for(var i=0;i<n.length;i++)n[i].apply(this,r)}}})),e}var t;define("apply/events",["apply/construct"],function(e){return n(e)})}(this),function(e){"use strict";function n(e){if(!t){t=!0;var n=function(e,t){e.list.push(t),e.trigger("add",t)},r=function(e,t){for(var n=0;n<e.list.length;n++)e.list[n]===t&&(e.list.splice(n,1),e.trigger("remove",t))},i=e.List=e.Events({urlRoot:"",mapping:e.Model,init:function(e){this.list=[],this.add(e)},size:function(){return this.list.length},get:function(e){return this.list[e]},add:function(t){if(e.isArray(t))for(var r in t)n(this,new this.mapping(t[r]));else if(t)if(e.getPrototypeOf(t)===e.getPrototypeOf(this.mapping))n(this,t);else{if(e.isComposed(t))throw"Attempted to add an incompatible model to a list.";n(this,new this.mapping(t))}return this},remove:function(t){e.isArray(t)||(t=[t]);for(var n in t)r(this,t[n]);return this},getUrl:function(){return this.urlRoot},deflate:function(){var e=[];for(var t=0;t<this.list.length;t++)e.push(this.list[t].deflate?this.list[t].deflate():this.list[t]);return e},inflate:function(e){return this.add(e)}})}return e}var t;define("apply/list",["apply/events","apply/model"],function(e){return n(e)})}(this),function(e){"use strict";function n(e){if(!t){t=!0;var n=function(){e.loop(arguments,function(e){this[e]=function(t){return this.log({level:e,message:t})}},{context:this})},r=e.Logger=e.compose({init:function(){this.levels={},this.config({debug:!0,info:!0,warning:!0,error:!0})},config:function(t){e.extend(this.levels,t);for(var r in t)this[r]||n.call(this,r)},log:function(e){var t=e.level;return t&&this.levels[t]&&e.message&&console.log(e.message),this}}).cascade("log",!0),i=e.logger=r.singleton()}return e}var t;define("apply/logger",["apply/construct"],function(e){return n(e)})}(this),function(e){"use strict";function n(e){if(!t){t=!0;var n=e.extend,r=function(e,t,n){if(t){e||(e={});for(var r in t)if(e[r]){var i=new t[r](e[r]);n&&(i.parent=n),e[r]=i}}return e},i=function(e,t){if(t)for(var n in t)e[n].deflate&&(e[n]=e[n].deflate());return e},s=e.Model=e.Events({id:"id",urlRoot:"",init:function(e){this.attributes={},this.set(e)},set:function(t){t&&e.isFunction(t.deflate)&&(t=t.deflate()),n(this.attributes,r(t,this.mappings,this));for(var i in t)this.trigger("change:"+i,this.attributes[i],this);return this.trigger("change",this.attributes[i],i),this},get:function(e){return this.attributes[e]},getId:function(){return this.attributes[this.id]},getUrl:function(){return this.urlRoot+(this.attributes.id?"/"+this.attributes.id:"")},deflate:function(){return i(n({},this.attributes),this.mappings)},inflate:function(e){return this.set(e)}})}return e}var t;define("apply/model",["apply/events"],function(e){return n(e)})}(this),function(e){"use strict";function n(e){return t||(t=!0,e.Router=e.compose({init:function(){this.routes={}},add:function(t){e.isString(t)&&(t={},arguments.length===2&&e.isFunction(arguments[1])&&(t[arguments[0]]=arguments[1]));try{for(var n in t)e.namespace(this.routes,n.replace(/^\//,"").replace(/\//g,"."),t[n])}catch(r){console.log(r)}return this},route:function(t){var n=t.replace(/^#?\/?/,"").split("/"),r=[],i=this.routes;for(var s=0;s<n.length;s++){var o=n[s];if(i[o])i=i[o];else{if(!i["*"])break;r.push(e.string.isNumeric(o)?Number(o):o),i=i["*"]}}e.isFunction(i)&&i.apply(this,r.concat([].slice.call(arguments,1)))}}),e.router=e.Router.singleton()),e}var t;define("apply/router",["apply/util","apply/construct"],function(e){return n(e)})}(this),function(e){"use strict";define("apply",["apply/construct","apply/core","apply/events","apply/list","apply/logger","apply/model","apply/router","apply/util"],function(e){return e})}(this),function(root){"use strict";function module($,apply){if(!defined){defined=!0;var extend=$.extend,proxy=$.proxy,when=$.when,resources={},outstanding={deferreds:[],add:function(e){return this.deferreds.push(e),e},wait:function(e){var t=when.apply($,this.deferreds);return e&&t.then(e),t}},dependency=apply.dependency=function(resource,promise){if(!resources[resource]){var deferred=outstanding.add($.ajax({url:resource}));apply.string.endsWith(resource,".js")&&deferred.then(function(source){return eval(source)}),resources[resource]=deferred}return resources[resource].promise(promise)};apply.dependencies=function(){var e=[];return apply.loop(arguments,function(t){e.push(dependency(t))}),when(e)},dependency.wait=proxy(outstanding.wait,outstanding),apply.ready=function(e){dependency.wait(e)};var wrapAjax=function(e){var t=$.Deferred(),n={};for(var r=1;r<arguments.length;r++)arguments[r]&&(apply.isFunction(arguments[r])?t.then(arguments[r]):arguments[r].success&&(t.then(arguments[r].success),delete arguments[r].success),extend(n,arguments[r]));return when($.ajax(n)).then(function(r){handleResponse(e,r,n),t.resolve(e,r,n)}),t.promise()},handleResponse=function(e,t,n){n.type==="GET"&&(apply.isFunction(e.inflate)?e.inflate(e.parse(t)):extend(e,t))},crud=apply.Crud=apply.Events({save:apply.delegateToParent("save",function(e){return wrapAjax(this,{contentType:this.contentType,data:this.toString(),type:this.getId&&this.getId()?"PUT":"POST",url:this.getUrl()},e)}),fetch:apply.delegateToParent("fetch",function(e){return wrapAjax(this,{url:this.getUrl(),type:"GET"},e)}),destroy:apply.delegateToParent("destroy",function(e){return wrapAjax(this,{url:this.getUrl(),type:"DELETE"},e)}),toString:function(){return JSON.stringify(this.deflate?this.deflate():this)},parse:function(e){return e},contentType:"application/json"});apply.List=apply.List(crud),apply.Model=apply.Model(crud);var div="<div></div>",preventDefault=function(e){return function(t){return t.preventDefault(),e.apply(this,arguments)}},bind=function(e,t,n){for(var r in t){var i=r.split(" ").pop(),s=t[r];i==="submit"&&(s=preventDefault(s)),e.on(i,r.replace(i,""),proxy(s,n))}},setupRootEl=function(e){e.$el=$(e.rootHtml),e.events&&bind(e.$el,e.events,e)},peel=function(e,t){if(t){var n=$(t);if(n.size()>1)throw(e.resource?e.resource:"All view source")+" must have a single root element.";e.template=e.compile(n.html()),e.rootHtml=$(div).html(n.empty()).html()}else e.template=e.compile("")},renderDataElement=function(e,t,n,r){var i=$(t),s=i.attr("data");e.set(i,apply.namespace(r,s)),n.on&&n.on("change:"+s,function(t){e.set(i,t)}),(i.is("input")||i.is("textarea"))&&i.on("change",function(e){var t=i.val();if(n.set){var r={};r[s]=t,n.set(r)}else n[s]=t})},dataBinding={render:function(){var e=this;this.data||(this.data=new apply.Model);var t=this.data,n=t;return t.deflate&&(n=t.deflate()),this.$el.attr("data")&&renderDataElement(this,this.$el,t,n),this.$el.find("[data]").each(function(r,i){renderDataElement(e,i,t,n)}),this.$el},set:function(e,t){e.is("input")||e.is("textarea")?e.val()!==t&&e.val(t):e.text()!==t&&e.text(t)}},view=apply.View=apply.compose({urlRoot:"",rootHtml:div,init:function(e){e=e||{},e.data&&(this.data=e.data)},template:function(){return""},render:function(){if(!this.template)throw"Please wait for "+this.resource+" before rendering.";return this.$el||setupRootEl(this),this.$el.html(this.template(this.data))},compile:function(e){return function(){return e||""}}},dataBinding).generator(function(){var e=this.prototype;e.resource?(delete e.template,apply.dependency(e.urlRoot+e.resource).promise(this),this.done(function(t){peel(e,t)})):peel(e,e.source)}).cascade("render");apply.mixins={view:{dataBinding:dataBinding,renderer:{dynamic:{attachTo:"",render:function(e){var t=this.$el;return e&&(this.attachTo?t.find(this.attachTo).html(e.render()):t.html(e.render())),t}},children:{children:{},render:function(e){var t=this.$el;for(var n in this.children){var r=t.find(n).empty();r.size()===0&&t.is(n)&&(r=t);var i=this.children[n];if(apply.isArray(i))for(var s=0;s<i.length;s++)r.append(i[s].render());else r.append(i.render())}return t}},list:{itemView:view,render:function(){var e=this.$el,t=e;this.attachTo&&(t=e.find(this.attachTo));var n=this.itemView,r=this.data||[];return r.list&&(r=r.list),$.each(r,function(e,r){t.append((new n({data:r})).render())}),e}}}}},apply.Router.Web=apply.Router({init:function(){this.current=undefined},check:function(){if(root.location.hash!==this.current){var e=this.current=root.location.hash;this.route(e)}},start:function(e){e=e||{};var t=proxy(this.check,this);return this.iid=setInterval(t,e.interval||50),this},stop:function(){clearInterval(this.iid),delete this.iid}});var router=apply.router=new apply.Router.Web}return apply}var defined=!1;define("apply/web",["jquery","apply"],function(e,t){return module(e,t)})}(this);